import asyncio
import os
import subprocess
from datetime import datetime
from aiogram import Bot, Dispatcher, F, types
from aiogram.filters import Command
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton, FSInputFile
from aiogram.client.session.aiohttp import AiohttpSession
from aiogram.fsm.context import FSMContext
from aiogram.fsm.state import State, StatesGroup
from aiogram.fsm.storage.memory import MemoryStorage

# ================= –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø =================

TOKEN = "YOUR_BOT_TOKEN_HERE"  # ‚Üê –í–°–¢–ê–í–¨–¢–ï –¢–û–ö–ï–ù

session = AiohttpSession(proxy=None)
bot = Bot(token=TOKEN, session=session)
storage = MemoryStorage()
dp = Dispatcher(storage=storage)

LUA_PATH = "lua55"
TEMP_DIR = "temp_files"
STATS_FILE = "bot_stats.txt"

if not os.path.exists(TEMP_DIR):
    os.makedirs(TEMP_DIR)

user_files = {}
user_languages = {}
user_stats = {}

class UserStates(StatesGroup):
    waiting_for_language = State()
    waiting_for_file = State()
    waiting_for_preset = State()

# ================= –¢–ï–ö–°–¢–´ =================

TEXTS = {
    "en": {
        "welcome": (
            "üëã **Welcome to Meloten Obfuscator Bot v2.1!**\n\n"
            "üîê Professional Lua code protection\n"
            "‚ö°Ô∏è 7 protection levels (NEW: Insane!)\n"
            "üõ° Multi-layer VM virtualization\n\n"
            "**New in v2.1:**\n"
            "‚Ä¢ Fixed Paranoid preset\n"
            "‚Ä¢ New INSANE preset (13 layers!)\n"
            "‚Ä¢ Enhanced deobfuscation resistance\n"
            "‚Ä¢ Improved stability\n\n"
            "Send me a `.lua` file to get started!"
        ),
        "select_language": "üåç Select your language:",
        "language_set": "‚úÖ Language set to English",
        "file_received": "‚úÖ File `{filename}` received!\n\nüìä File size: {size} KB\n\nüéØ Select protection level:",
        "wrong_extension": "‚ùå Please send a `.lua` file",
        "processing": "‚öôÔ∏è Processing with **{preset}** preset...\n\n‚è≥ {layers} protection layers\n\nPlease wait...",
        "success": (
            "‚úÖ **Obfuscation complete!**\n\n"
            "üìä **Statistics:**\n"
            "‚Ä¢ Preset: {preset}\n"
            "‚Ä¢ Input: {input_size} KB\n"
            "‚Ä¢ Output: {output_size} KB\n"
            "‚Ä¢ Increase: {ratio}%\n"
            "‚Ä¢ Layers: {layers}\n"
            "‚Ä¢ Time: {time}s\n\n"
            "üóë Files deleted from memory."
        ),
        "help": (
            "üìñ **Meloten Obfuscator v2.1**\n\n"
            "**Commands:**\n"
            "/start - Start bot\n"
            "/help - This help\n"
            "/presets - View presets\n"
            "/stats - Statistics\n"
            "/language - Change language\n"
            "/about - About bot\n\n"
            "**Protection levels:**\n"
            "‚ö°Ô∏è Light - Fast (2 layers)\n"
            "‚≠êÔ∏è Medium - Balanced (4 layers)\n"
            "üîí Strong - High (7 layers)\n"
            "üõ° Extreme - Maximum (7 layers)\n"
            "üî• Ultra - Anti-deobf (10 layers)\n"
            "üíÄ Paranoid - Extreme (13 layers)\n"
            "üòà Insane - ABSOLUTE (13 layers)"
        ),
        "presets_info": (
            "üéØ **Protection Levels**\n\n"
            "**‚ö°Ô∏è Light**\n"
            "2 layers | +60% size | 1.1x speed\n"
            "Basic VM + Constants\n\n"
            "**‚≠êÔ∏è Medium**\n"
            "4 layers | +200% size | 1.5x speed\n"
            "VM + Constants + Proxy + Wrap\n\n"
            "**üîí Strong**\n"
            "7 layers | +500% size | 2.5x speed\n"
            "+ String split + Encryption\n\n"
            "**üõ° Extreme**\n"
            "7 layers | +900% size | 4x speed\n"
            "+ Enhanced settings\n\n"
            "**üî• Ultra Strong**\n"
            "10 layers | +1200% size | 6x speed\n"
            "Double VM + Double wrap\n"
            "Deobfuscator resistant\n\n"
            "**üíÄ Paranoid** (FIXED!)\n"
            "13 layers | +2000% size | 10x speed\n"
            "Triple VM + Triple wrap\n"
            "Maximum protection\n\n"
            "**üòà Insane** (NEW!)\n"
            "13 layers | +2500% size | 15x speed\n"
            "4x VM virtualization\n"
            "3x Wrapping\n"
            "2x Proxy + 2x Constants\n"
            "ABSOLUTE protection!"
        ),
        "about": (
            "‚ÑπÔ∏è **Meloten Obfuscator Bot**\n\n"
            "üîê Version: 2.1\n"
            "‚ö°Ô∏è Based on: Prometheus\n\n"
            "**v2.1 Updates:**\n"
            "‚úÖ Fixed Paranoid crash\n"
            "‚úÖ New Insane preset\n"
            "‚úÖ 13-layer protection\n"
            "‚úÖ Better stability\n\n"
            "Bot: @Meloten_Obfuscatorbot\n"
            "Made with ‚ù§Ô∏è for Lua devs"
        ),
    },
    "ru": {
        "welcome": (
            "üëã **Meloten Obfuscator Bot v2.1!**\n\n"
            "üîê –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ Lua\n"
            "‚ö°Ô∏è 7 —É—Ä–æ–≤–Ω–µ–π –∑–∞—â–∏—Ç—ã (NEW: Insane!)\n"
            "üõ° –ú–Ω–æ–≥–æ—Å–ª–æ–π–Ω–∞—è VM –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è\n\n"
            "**–ù–æ–≤–æ–µ –≤ v2.1:**\n"
            "‚Ä¢ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω Paranoid\n"
            "‚Ä¢ –ù–æ–≤—ã–π –ø—Ä–µ—Å–µ—Ç INSANE (13 —Å–ª–æ—ë–≤!)\n"
            "‚Ä¢ –£—Å–∏–ª–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏\n"
            "‚Ä¢ –£–ª—É—á—à–µ–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å\n\n"
            "–û—Ç–ø—Ä–∞–≤—å `.lua` —Ñ–∞–π–ª –¥–ª—è –Ω–∞—á–∞–ª–∞!"
        ),
        "select_language": "üåç –í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫:",
        "language_set": "‚úÖ –Ø–∑—ã–∫: –†—É—Å—Å–∫–∏–π",
        "file_received": "‚úÖ –§–∞–π–ª `{filename}` –ø–æ–ª—É—á–µ–Ω!\n\nüìä –†–∞–∑–º–µ—Ä: {size} –ö–ë\n\nüéØ –í—ã–±–µ—Ä–∏ —É—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã:",
        "wrong_extension": "‚ùå –ù—É–∂–µ–Ω `.lua` —Ñ–∞–π–ª",
        "processing": "‚öôÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ **{preset}**...\n\n‚è≥ –°–ª–æ—ë–≤ –∑–∞—â–∏—Ç—ã: {layers}\n\n–ü–æ–¥–æ–∂–¥–∏...",
        "success": (
            "‚úÖ **–ì–æ—Ç–æ–≤–æ!**\n\n"
            "üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**\n"
            "‚Ä¢ –ü—Ä–µ—Å–µ—Ç: {preset}\n"
            "‚Ä¢ –í—Ö–æ–¥: {input_size} –ö–ë\n"
            "‚Ä¢ –í—ã—Ö–æ–¥: {output_size} –ö–ë\n"
            "‚Ä¢ –†–æ—Å—Ç: {ratio}%\n"
            "‚Ä¢ –°–ª–æ—ë–≤: {layers}\n"
            "‚Ä¢ –í—Ä–µ–º—è: {time}—Å\n\n"
            "üóë –§–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã."
        ),
        "help": (
            "üìñ **Meloten Obfuscator v2.1**\n\n"
            "**–ö–æ–º–∞–Ω–¥—ã:**\n"
            "/start - –ó–∞–ø—É—Å–∫\n"
            "/help - –°–ø—Ä–∞–≤–∫–∞\n"
            "/presets - –ü—Ä–µ—Å–µ—Ç—ã\n"
            "/stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
            "/language - –Ø–∑—ã–∫\n"
            "/about - –û –±–æ—Ç–µ\n\n"
            "**–£—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã:**\n"
            "‚ö°Ô∏è Light - –ë—ã—Å—Ç—Ä–æ (2 —Å–ª–æ—è)\n"
            "‚≠êÔ∏è Medium - –ë–∞–ª–∞–Ω—Å (4 —Å–ª–æ—è)\n"
            "üîí Strong - –í—ã—Å–æ–∫–∞—è (7 —Å–ª–æ—ë–≤)\n"
            "üõ° Extreme - –ú–∞–∫—Å (7 —Å–ª–æ—ë–≤)\n"
            "üî• Ultra - –ê–Ω—Ç–∏-–¥–µ–æ–±—Ñ (10 —Å–ª–æ—ë–≤)\n"
            "üíÄ Paranoid - –≠–∫—Å—Ç—Ä–∏–º (13 —Å–ª–æ—ë–≤)\n"
            "üòà Insane - –ê–ë–°–û–õ–Æ–¢ (13 —Å–ª–æ—ë–≤)"
        ),
        "presets_info": (
            "üéØ **–£—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã**\n\n"
            "**‚ö°Ô∏è Light**\n"
            "2 —Å–ª–æ—è | +60% | —Å–∫–æ—Ä–æ—Å—Ç—å 1.1x\n"
            "–ë–∞–∑–æ–≤–∞—è VM + –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã\n\n"
            "**‚≠êÔ∏è Medium**\n"
            "4 —Å–ª–æ—è | +200% | 1.5x\n"
            "VM + –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã + –ü—Ä–æ–∫—Å–∏ + –û–±—ë—Ä—Ç–∫–∞\n\n"
            "**üîí Strong**\n"
            "7 —Å–ª–æ—ë–≤ | +500% | 2.5x\n"
            "+ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ + –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ\n\n"
            "**üõ° Extreme**\n"
            "7 —Å–ª–æ—ë–≤ | +900% | 4x\n"
            "+ –£–ª—É—á—à–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏\n\n"
            "**üî• Ultra Strong**\n"
            "10 —Å–ª–æ—ë–≤ | +1200% | 6x\n"
            "–î–≤–æ–π–Ω–∞—è VM + –î–≤–æ–π–Ω–∞—è –æ–±—ë—Ä—Ç–∫–∞\n"
            "–ó–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä–æ–≤\n\n"
            "**üíÄ Paranoid** (–ò–°–ü–†–ê–í–õ–ï–ù!)\n"
            "13 —Å–ª–æ—ë–≤ | +2000% | 10x\n"
            "–¢—Ä–æ–π–Ω–∞—è VM + –¢—Ä–æ–π–Ω–∞—è –æ–±—ë—Ä—Ç–∫–∞\n"
            "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞\n\n"
            "**üòà Insane** (–ù–û–í–´–ô!)\n"
            "13 —Å–ª–æ—ë–≤ | +2500% | 15x\n"
            "4x VM –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è\n"
            "3x –û–±—ë—Ä—Ç–∫–∏\n"
            "2x –ü—Ä–æ–∫—Å–∏ + 2x –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã\n"
            "–ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –∑–∞—â–∏—Ç–∞!"
        ),
        "about": (
            "‚ÑπÔ∏è **Meloten Obfuscator Bot**\n\n"
            "üîê –í–µ—Ä—Å–∏—è: 2.1\n"
            "‚ö°Ô∏è –û—Å–Ω–æ–≤–∞: Prometheus\n\n"
            "**v2.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏—è:**\n"
            "‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫—Ä–∞—à Paranoid\n"
            "‚úÖ –ù–æ–≤—ã–π Insane –ø—Ä–µ—Å–µ—Ç\n"
            "‚úÖ 13-—Å–ª–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞\n"
            "‚úÖ –õ—É—á—à–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å\n\n"
            "–ë–æ—Ç: @Meloten_Obfuscatorbot\n"
            "–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è Lua"
        ),
    }
}

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ—ë–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ—Å–µ—Ç–∞
PRESET_LAYERS = {
    "Light": 2,
    "Medium": 4,
    "Strong": 7,
    "Extreme": 7,
    "UltraStrong": 10,
    "Paranoid": 13,
    "Insane": 13
}

def get_text(user_id: int, key: str, **kwargs) -> str:
    lang = user_languages.get(user_id, "en")
    text = TEXTS.get(lang, TEXTS["en"]).get(key, TEXTS["en"][key])
    return text.format(**kwargs) if kwargs else text

def update_user_stats(user_id: int, preset: str, input_size: int, output_size: int, time: float):
    if user_id not in user_stats:
        user_stats[user_id] = {
            "count": 0,
            "input_total": 0,
            "output_total": 0,
            "time_total": 0,
            "presets": {},
            "first_use": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
            "last_use": ""
        }
    
    stats = user_stats[user_id]
    stats["count"] += 1
    stats["input_total"] += input_size
    stats["output_total"] += output_size
    stats["time_total"] += time
    stats["presets"][preset] = stats["presets"].get(preset, 0) + 1
    stats["last_use"] = datetime.now().strftime("%Y-%m-%d %H:%M:%S")

def get_language_keyboard():
    buttons = [
        [
            InlineKeyboardButton(text="üá¨üáß English", callback_data="lang_en"),
            InlineKeyboardButton(text="üá∑üá∫ –†—É—Å—Å–∫–∏–π", callback_data="lang_ru")
        ]
    ]
    return InlineKeyboardMarkup(inline_keyboard=buttons)

def get_presets_keyboard(lang="en"):
    buttons = [
        [
            InlineKeyboardButton(text="‚ö°Ô∏è Light", callback_data="preset_Light"),
            InlineKeyboardButton(text="‚≠êÔ∏è Medium", callback_data="preset_Medium")
        ],
        [
            InlineKeyboardButton(text="üîí Strong", callback_data="preset_Strong"),
            InlineKeyboardButton(text="üõ° Extreme", callback_data="preset_Extreme")
        ],
        [
            InlineKeyboardButton(text="üî• Ultra", callback_data="preset_UltraStrong"),
            InlineKeyboardButton(text="üíÄ Paranoid", callback_data="preset_Paranoid")
        ],
        [
            InlineKeyboardButton(text="üòà Insane", callback_data="preset_Insane")
        ]
    ]
    return InlineKeyboardMarkup(inline_keyboard=buttons)

# ================= –ö–û–ú–ê–ù–î–´ =================

@dp.message(Command("start"))
async def cmd_start(message: types.Message, state: FSMContext):
    user_id = message.from_user.id
    
    if user_id not in user_languages:
        await message.answer(
            "üåç **Welcome! | –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!**\n\nSelect language | –í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫:",
            reply_markup=get_language_keyboard(),
            parse_mode="Markdown"
        )
        await state.set_state(UserStates.waiting_for_language)
    else:
        await message.answer(get_text(user_id, "welcome"), parse_mode="Markdown")

@dp.message(Command("help"))
async def cmd_help(message: types.Message):
    await message.answer(get_text(message.from_user.id, "help"), parse_mode="Markdown")

@dp.message(Command("presets"))
async def cmd_presets(message: types.Message):
    await message.answer(get_text(message.from_user.id, "presets_info"), parse_mode="Markdown")

@dp.message(Command("about"))
async def cmd_about(message: types.Message):
    await message.answer(get_text(message.from_user.id, "about"), parse_mode="Markdown")

@dp.message(Command("language"))
async def cmd_language(message: types.Message, state: FSMContext):
    await message.answer(
        get_text(message.from_user.id, "select_language"),
        reply_markup=get_language_keyboard()
    )
    await state.set_state(UserStates.waiting_for_language)

@dp.message(Command("stats"))
async def cmd_stats(message: types.Message):
    user_id = message.from_user.id
    if user_id not in user_stats or user_stats[user_id]["count"] == 0:
        lang = user_languages.get(user_id, "en")
        no_stats = "üìä No statistics yet!" if lang == "en" else "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–∫–∞ –Ω–µ—Ç!"
        await message.answer(no_stats)
        return
    
    stats = user_stats[user_id]
    favorite = max(stats["presets"].items(), key=lambda x: x[1])[0] if stats["presets"] else "N/A"
    
    lang = user_languages.get(user_id, "en")
    text = (
        f"üìä **{'Statistics' if lang == 'en' else '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞'}:**\n\n"
        f"üóÇ {'Files' if lang == 'en' else '–§–∞–π–ª–æ–≤'}: {stats['count']}\n"
        f"üìà {'Input total' if lang == 'en' else '–í—Ö–æ–¥ –≤—Å–µ–≥–æ'}: {round(stats['input_total']/1024, 2)} KB\n"
        f"üìä {'Output total' if lang == 'en' else '–í—ã—Ö–æ–¥ –≤—Å–µ–≥–æ'}: {round(stats['output_total']/1024, 2)} KB\n"
        f"‚è± {'Time' if lang == 'en' else '–í—Ä–µ–º—è'}: {round(stats['time_total'], 2)}s\n"
        f"üî• {'Favorite' if lang == 'en' else '–õ—é–±–∏–º—ã–π'}: {favorite}\n\n"
        f"{'First' if lang == 'en' else '–ü–µ—Ä–≤—ã–π'}: {stats['first_use']}\n"
        f"{'Last' if lang == 'en' else '–ü–æ—Å–ª–µ–¥–Ω–∏–π'}: {stats['last_use']}"
    )
    await message.answer(text, parse_mode="Markdown")

# ================= CALLBACKS =================

@dp.callback_query(F.data.startswith("lang_"))
async def process_language(callback: types.CallbackQuery, state: FSMContext):
    lang = callback.data.split("_")[1]
    user_id = callback.from_user.id
    user_languages[user_id] = lang
    
    await callback.message.edit_text(get_text(user_id, "language_set"), parse_mode="Markdown")
    await callback.message.answer(get_text(user_id, "welcome"), parse_mode="Markdown")
    await state.clear()
    await callback.answer()

@dp.callback_query(F.data.startswith("preset_"))
async def process_obfuscation(callback: types.CallbackQuery):
    user_id = callback.from_user.id
    preset = callback.data.split("_")[1]
    
    if user_id not in user_files:
        await callback.message.answer(get_text(user_id, "no_file") if user_id in user_languages else "‚ùå No file")
        await callback.answer()
        return
    
    input_path = user_files[user_id]
    output_filename = os.path.basename(input_path).replace(".lua", "_obf.lua")
    output_path = os.path.join(TEMP_DIR, output_filename)
    
    layers = PRESET_LAYERS.get(preset, "?")
    await callback.message.edit_text(
        get_text(user_id, "processing", preset=preset, layers=layers),
        parse_mode="Markdown"
    )
    
    start_time = datetime.now()
    
    try:
        process = await asyncio.create_subprocess_exec(
            LUA_PATH,
            "run_obfuscator.lua",
            input_path,
            output_path,
            preset,
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE
        )
        
        stdout, stderr = await process.communicate()
        
        if process.returncode != 0:
            error_msg = stderr.decode().strip() or stdout.decode().strip()
            await callback.message.edit_text(f"‚ùå Error:\n```\n{error_msg[:500]}\n```", parse_mode="Markdown")
            return
        
        if os.path.exists(output_path):
            end_time = datetime.now()
            elapsed = (end_time - start_time).total_seconds()
            
            input_size = os.path.getsize(input_path)
            output_size = os.path.getsize(output_path)
            ratio = round((output_size / input_size - 1) * 100, 1) if input_size > 0 else 0
            
            update_user_stats(user_id, preset, input_size, output_size, elapsed)
            
            result_file = FSInputFile(output_path)
            await bot.send_document(
                chat_id=callback.message.chat.id,
                document=result_file,
                caption=get_text(
                    user_id, "success",
                    preset=preset,
                    input_size=round(input_size/1024, 2),
                    output_size=round(output_size/1024, 2),
                    ratio=ratio,
                    layers=layers,
                    time=round(elapsed, 2)
                ),
                parse_mode="Markdown",
                request_timeout=600
            )
            
            del user_files[user_id]
    
    except Exception as e:
        await callback.message.edit_text(f"‚ùå Error: {str(e)}", parse_mode="Markdown")
    finally:
        if os.path.exists(input_path):
            os.remove(input_path)
        if os.path.exists(output_path):
            os.remove(output_path)
    
    await callback.answer()

# ================= –î–û–ö–£–ú–ï–ù–¢–´ =================

@dp.message(F.document)
async def handle_document(message: types.Message):
    user_id = message.from_user.id
    document = message.document
    file_name = document.file_name
    
    if not file_name.endswith(".lua"):
        await message.answer(get_text(user_id, "wrong_extension"))
        return
    
    file_id = document.file_id
    file = await bot.get_file(file_id)
    
    local_filename = f"{user_id}_{file_name}"
    local_path = os.path.join(TEMP_DIR, local_filename)
    
    await bot.download_file(file.file_path, local_path)
    user_files[user_id] = local_path
    
    file_size = round(os.path.getsize(local_path) / 1024, 2)
    
    await message.answer(
        get_text(user_id, "file_received", filename=file_name, size=file_size),
        reply_markup=get_presets_keyboard(user_languages.get(user_id, "en")),
        parse_mode="Markdown"
    )

# ================= –ó–ê–ü–£–°–ö =================

async def main():
    print("üöÄ Meloten Obfuscator Bot v2.1 started!")
    await dp.start_polling(bot)

if __name__ == "__main__":
    try:
        asyncio.run(main())
    except KeyboardInterrupt:
        print("\nüëã Bot stopped") 
