-- run_obfuscator.lua
-- Этот скрипт запускается Питоном

local Meloten = require("meloten") -- Подключаем твое ядро

-- Получаем аргументы от Python (из командной строки)
local input_file = arg[1]
local output_file = arg[2]
local preset = arg[3] or "Medium" -- Если пресет не передан, ставим Medium

print("Lua: Начинаю обработку...")
print("Вход: " .. input_file)
print("Пресет: " .. preset)

-- Запускаем обфускацию
-- (Убедись, что функция называется именно так, как в твоем модуле)
local success, err = pcall(function()
    Meloten.obfuscateFile(input_file, output_file, preset)
end)

if success then
    print("Lua: Готово!")
else
    print("Lua: Ошибка - " .. tostring(err))
    os.exit(1) -- Сообщаем Питону, что произошла ошибка
end
